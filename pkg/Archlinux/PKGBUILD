# Maintainer: Jan Veen <jan.veen Ã¦t posteo.de>
pkgname=alerter
pkgver=0.1.0
pkgrel=1
pkgdesc="Alerter to Slack"
arch=('x86_64')
url="https://gitlab.com/veenj/alerter"
license=('GPL3')
depends=()
makedepends=('rust')
backup=('etc/alerter.yml')
source=('http://www.do.not.use.com/package.tar')
sha512sums=('SKIP')

build() {
    cd "$srcdir"
    cargo build --release
}

check() {
    cd "$srcdir"
    cargo fmt --all -- --check
    cargo clippy --release -j 8 -- -D clippy::all
    cargo test -j 1
}

package() {
    cd "$srcdir"

    install -D -m 755 target/release/alerter $pkgdir/usr/bin/alerter
    install -D -m 755 target/release/alert $pkgdir/usr/bin/alert
    install -D -m 644 pkg/config.yml $pkgdir/etc/alerter.yml
    install -D -m 644 pkg/systemd.service $pkgdir/usr/lib/systemd/system/alerter.service
}
